# 測試說明：「開始AI審核」按鈕功能 + 頁面大小控制

## 功能變更摘要
1. **新增「開始AI審核」按鈕**：位於面板 header 區塊，具有漸層藍紫色樣式
2. **調整審核流程**：從自動審核改為手動觸發
3. **狀態顯示優化**：新增「待審核」狀態並配色
4. **強化頁面大小控制**：確保每頁顯示 100 筆資料，提高資料掃描完整性

## 測試項目

### 1. 按鈕外觀測試 ✅
- [ ] 按鈕顯示在面板 header 正確位置
- [ ] 按鈕具有漸層藍紫色背景
- [ ] 按鈕文字為「開始AI審核」
- [ ] 滑鼠懸停時有適當的游標樣式

### 2. 功能流程測試 ✅  
- [ ] 初始掃描後，詳細log顯示「待審核」狀態（藍色背景）
- [ ] 點擊按鈕前，不會自動發送AI審核請求
- [ ] 點擊按鈕後：
  - [ ] 按鈕文字變為「AI審核中...」
  - [ ] 按鈕被禁用（disabled）
  - [ ] 按鈕透明度降低（0.6）
- [ ] 審核完成後：
  - [ ] 按鈕文字變為「審核完成」（2秒）
  - [ ] 然後恢復為「開始AI審核」
  - [ ] 按鈕重新啟用

### 3. 資料狀態測試 ✅
- [ ] 審核前：log表格顯示「待審核」（藍色）
- [ ] 審核後：log表格顯示實際評估結果
  - [ ] 「是」（綠色背景）
  - [ ] 「否」（紅色背景） 
  - [ ] 「部分」（黃色背景）
- [ ] KPI摘要正確更新解決率和正確率

### 4. 頁面大小控制測試 ✅
- [ ] 頁面載入時自動設定為 100 筆資料
- [ ] 分頁連結都包含 `size=100` 參數
- [ ] 頁面大小選擇器正確標示 100 為目前選擇
- [ ] URL 自動更新為包含 `size=100`
- [ ] 資料掃描時強制使用 100 筆頁面大小
- [ ] 頁面導航後仍保持 100 筆設定
- [ ] 監聽器正確偵測分頁器變更並重新設定大小

### 5. 錯誤處理測試 ✅
- [ ] 未掃描資料時點擊按鈕，顯示提示訊息
- [ ] 網路錯誤時，按鈕顯示「審核失敗」並恢復
- [ ] 無需審核項目時，顯示適當訊息

### 6. 性能測試 ✅
- [ ] 大量資料時，批次審核不會阻塞UI
- [ ] 審核過程中可以正常操作其他按鈕
- [ ] 記憶體使用正常，無洩漏
- [ ] 100 筆資料的頁面載入性能正常

## 頁面大小控制改進詳情

### 新增功能
1. **自動設定頁面大小**：頁面載入時自動設定為 100 筆
2. **分頁連結更新**：所有分頁連結都強制包含 `size=100`
3. **URL 自動修正**：位址列 URL 自動更新為 100 筆
4. **監聽器機制**：監聽 DOM 變更，確保分頁器變更後重新設定大小
5. **掃描強化**：資料掃描時強制使用 100 筆頁面大小

### 技術實作
- 增強 `setPagerSizeTo100()` 函數：
  - 更新所有分頁連結
  - 設定頁面大小選擇器
  - 更新 URL 參數
  - 處理表單輸入元素
  - 增加偵錯訊息
- 在關鍵位置調用：
  - 頁面初始化
  - 範圍應用後
  - 資料掃描前
  - DOM 變更時

## 預期行為變更

### 之前（自動審核）
```
掃描資料 → 自動顯示「AI審核中」→ 背景審核 → 更新結果
```

### 現在（手動審核 + 頁面大小控制）
```
頁面載入 → 設定100筆 → 掃描資料 → 顯示「待審核」→ 使用者點擊按鈕 → 批次審核 → 更新結果
```

## 注意事項
- 確保 background.js 中的 LLM API 端點正常運作
- 檢查快取機制避免重複審核同一問答對
- 驗證批次處理不會超過API限制
- 監控 100 筆資料的網路請求效能
- 確認 DOM 監聽器不會造成記憶體洩漏

## 測試環境
- 瀏覽器：Chrome/Edge（Manifest V3）
- 目標頁面：MIS Bot UserChat 分析頁面
- 測試資料：包含用戶問題和GPT回答的對話記錄
- 頁面大小：強制 100 筆資料顯示